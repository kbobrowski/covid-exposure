(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[7],{344:function(e,t,a){"use strict";var n=1/0;function r(){var e=document.documentElement.scrollTop||document.body.scrollTop;e>0&&n>e?(n=e,window.requestAnimationFrame(r),window.scrollTo(0,e-e/8)):n=1/0}t.a=function(){setTimeout((function(){r()}),10)}},376:function(e,t,a){"use strict";var n=a(328),r=a(0),o=a.n(r),c=a(5);t.a=function(e){var t=e.component,a=Object(n.a)(e,["component"]);return o.a.createElement(c.a,Object.assign({},a,{render:function(e){return function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];var r=Object.assign.apply(Object,[{}].concat(a));return o.a.createElement(e,r)}(t,e,a)}}))}},377:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(89),c=a(972),i=a(973),s=a(952),l=a(936),u=a(953),m=a(937),d=a(934),p=a(948),g=a(930),h=a(86),b=a(435),f=a.n(b);t.a=Object(c.a)()(Object(h.a)((function(e){return{closeIcon:{marginRight:e.spacing(.5)},headSection:{width:200},blackList:{backgroundColor:e.palette.common.black,height:"100%"},noDecoration:{textDecoration:"none !important"}}}),{withTheme:!0})((function(e){var t=e.width,a=e.open,h=e.onClose,b=e.anchor,E=e.classes,y=e.menuItems,k=e.selectedItem,v=e.theme;return Object(n.useEffect)((function(){window.onresize=function(){Object(c.c)("sm",t)&&a&&h()}}),[t,a,h]),r.a.createElement(i.a,{variant:"temporary",open:a,onClose:h,anchor:b},r.a.createElement(s.a,{className:E.headSection},r.a.createElement(l.a,{style:{paddingTop:v.spacing(0),paddingBottom:v.spacing(0),height:"100%",justifyContent:"left"===b?"flex-start":"flex-end"},disableGutters:!0},r.a.createElement(u.a,{className:E.closeIcon},r.a.createElement(m.a,{onClick:h,"aria-label":"Close Navigation"},r.a.createElement(f.a,{color:"primary"}))))),r.a.createElement(d.a,{className:E.blackList},y.map((function(e){return e.link?r.a.createElement(o.b,{key:e.name,to:e.link,className:E.noDecoration,onClick:h},r.a.createElement(l.a,{button:!0,selected:k===e.name,disableRipple:!0,disableTouchRipple:!0},r.a.createElement(u.a,null,e.icon),r.a.createElement(p.a,{primary:r.a.createElement(g.a,{variant:"subtitle1",className:"text-white"},e.name)}))):e.href?r.a.createElement("a",{href:e.href},r.a.createElement(l.a,{button:!0,selected:k===e.name,disableRipple:!0,disableTouchRipple:!0},r.a.createElement(u.a,null,e.icon),r.a.createElement(p.a,{primary:r.a.createElement(g.a,{variant:"subtitle1",className:"text-white"},e.name)}))):r.a.createElement(l.a,{button:!0,key:e.name,onClick:e.onClick},r.a.createElement(u.a,null,e.icon),r.a.createElement(p.a,{primary:r.a.createElement(g.a,{variant:"subtitle1",className:"text-white"},e.name)}))}))))})))},576:function(e,t,a){"use strict";var n=t.CheckedDKs={};n.read=function(e,t){return e.readFields(n._readField,{checkedDKs:[]},t)},n._readField=function(e,t,a){1===e&&t.checkedDKs.push(a.readString())},n.write=function(e,t){if(e.checkedDKs)for(var a=0;a<e.checkedDKs.length;a++)t.writeStringField(1,e.checkedDKs[a])}},959:function(e,t,a){"use strict";a.r(t);var n=a(26),r=a.n(n),o=a(21),c=a(34),i=a(47),s=a(9),l=a(0),u=a.n(l),m=a(295),d=a.n(m),p=a(86),g=a(5),h=a(961),b=a(930),f=a(962),E=a(971),y=a(935),k=a(965),v=a(938),O=a(967),w=a(946),j=a(947),x=a(934),C=a(936),D=a(948),T=a(949),S=a(950),R=a(434),M=a.n(R),N=a(966),B=a(572),K=a.n(B);var L=Object(p.a)((function(e){return{tooltipTypo:Object(o.a)({whiteSpace:"pre-line !important"},e.typography.caption,{color:e.palette.common.white}),tooltip:{verticalAlign:"middle",fontSize:"1.25rem"},helpIcon:{marginLeft:e.spacing(1),"@media (max-width: 350px)":{marginLeft:e.spacing(.5)},transition:e.transitions.create(["color"],{duration:e.transitions.duration.short,easing:e.transitions.easing.easeInOut})}}}),{withTheme:!0})((function(e){var t=e.classes,a=e.title,n=Object(l.useState)(!1),r=Object(i.a)(n,2),o=r[0],c=r[1],s=Object(l.useCallback)((function(){c(!0)}),[]),m=Object(l.useCallback)((function(){c(!1)}),[]);return u.a.createElement(N.a,{title:u.a.createElement(b.a,{variant:"body2",className:t.tooltipTypo},a),className:t.tooltip,enterTouchDelay:300},u.a.createElement(K.a,{onMouseOver:s,onFocus:s,onBlur:m,onMouseLeave:m,color:o?"primary":"inherit",className:t.helpIcon,style:{cursor:o?"pointer":"auto"}}))}));var I=Object(p.a)((function(e){return{wrapper:{border:"".concat(e.border.borderWidth,"px solid ").concat(e.border.borderColor)},greyed:{border:"".concat(e.border.borderWidth,"px solid rgba(0, 0, 0, 0.23)")}}}),{withTheme:!0})((function(e){var t=e.classes,a=e.theme,n=e.disableVerticalPadding,r=e.disableBorderRadius,o=e.children,c=e.variant;return u.a.createElement("div",{className:"greyed"===c?t.greyed:t.wrapper,style:{paddingLeft:n?0:a.spacing(2),paddingRight:n?0:a.spacing(2),borderRadius:r?0:a.shape.borderRadius}},o)})),A=a(931);var P=Object(p.a)((function(e){return{circularProgress:{color:e.palette.secondary.main}}}),{withTheme:!0})((function(e){var t=e.size,a=e.classes;return u.a.createElement(h.a,{color:"secondary.main",pl:1.5,display:"flex"},u.a.createElement(A.a,{size:t||24,thickness:t?t/5*24:5,className:a.circularProgress}))})),F=a(48),z=a(939),W=a(942),U=a(943),H=a(944),V=a(945),q=a(31),X=a.n(q);var G=Object(p.a)((function(e){var t,a;return{numberInput:(t={width:120},Object(s.a)(t,e.breakpoints.down("sm"),{width:80}),Object(s.a)(t,"@media (max-width: 350px)",{width:65}),t),numberInputInput:{padding:"9px 14.5px","@media (max-width: 380px)":{padding:"9px 8.5px"},"@media (max-width: 350px)":{padding:"9px 6.5px"}},listItem:(a={},Object(s.a)(a,e.breakpoints.up("sm"),{paddingLeft:e.spacing(4)}),Object(s.a)(a,"paddingLeft",100),a),AccordionDetails:{paddingTop:e.spacing(0),justifyContent:"flex-end"},dBlock:{display:"block"}}}),{withTheme:!0})((function(e){var t=e.pushMessageToSnackbar,a=e.classes,n=Object(l.useContext)(F.a),r=n.downloadCountries,o=n.cachingEnabled,c=n.numberWebWorkers,s=n.dispatch,m=Object(l.useState)(!0),d=Object(i.a)(m,2),p=d[0],g=d[1],h=Object(l.useState)(!1),R=Object(i.a)(h,2),N=R[0],B=R[1],K=Object(l.useState)(!1),A=Object(i.a)(K,2),q=A[0],G=A[1],J={open:!1,title:"",text:u.a.createElement("div",null,"empty")},$=Object(l.useState)(J),Y=Object(i.a)($,2),_=Y[0],Q=Y[1],Z=[{title:"Number of workers",secondaryAction:u.a.createElement(f.a,{value:c.toString(),input:u.a.createElement(E.a,{onChange:function(e){var t=e.target.value;s&&s({type:"setNumberWebWorkers",payload:parseInt(t)})},labelWidth:0,className:a.numberInput,classes:{input:a.numberInputInput},name:"number-of-workers"})},Array.from(Array(8).keys()).map((function(e){return e+1})).map((function(e){return u.a.createElement(y.a,{value:e.toString()},e.toString())})))},{title:"Store Diagnosis Keys with no match and skip them next time",secondaryAction:u.a.createElement(k.a,{value:"Caching enabled",color:"primary",checked:o,onChange:function(e){s&&s({type:"setCachingEnabled",payload:e.target.checked})}}),helpText:"Do not match Diagnosis Keys which led to no match in previous runs. Available only in hosted mode."},{title:"Remove stored Diagnosis Keys",secondaryAction:u.a.createElement(v.a,{variant:"contained",color:"primary",disabled:q,onClick:function(){G(!0),X.a.delete("/checked").then((function(e){t({text:"Checked Diagnosis Keys removed"})})).catch((function(e){t({text:"Error removing checked Diagnosis Keys: "+e})})).finally((function(){return setTimeout((function(){return G(!1)}),1e3)}))}},"Remove ",q&&u.a.createElement(P,null)),helpText:"Remove stored Diagnosis Keys which led to no match in previous runs. Available only in hosted mode."}],ee=r.map((function(e,t){return{title:e.name,secondaryAction:u.a.createElement(k.a,{key:t,value:e.name,color:"primary",checked:e.enabled,onChange:function(t){s&&s({type:"setCountryEnabledState",payload:{countryName:e.name,enabled:t.target.checked}})}})}}));return u.a.createElement("div",null,u.a.createElement(z.a,{fullScreen:!1,open:_.open,onClose:function(){return Q(J)},"aria-labelledby":"help"},u.a.createElement(W.a,{id:"help"},_.title),u.a.createElement(U.a,null,u.a.createElement(H.a,null,_.text)),u.a.createElement(V.a,null,u.a.createElement(v.a,{autoFocus:!0,onClick:function(){return Q(J)},color:"primary"},"Close"))),u.a.createElement(O.a,{expanded:p,onChange:function(e,t){return g(t)}},u.a.createElement(w.a,{expandIcon:u.a.createElement(M.a,null)},u.a.createElement(b.a,null,"Countries")),u.a.createElement(j.a,{className:a.dBlock},u.a.createElement(x.a,{disablePadding:!0},u.a.createElement(I,{disableVerticalPadding:!0,disableBorderRadius:!0},ee.map((function(e,t){return u.a.createElement(C.a,{key:t,divider:t!==ee.length-1,className:"listItemLeftPadding"},u.a.createElement(D.a,null,u.a.createElement(b.a,{variant:"body2"},e.title,e.helpText&&u.a.createElement(L,{title:e.helpText}))),u.a.createElement(T.a,null,u.a.createElement(S.a,{variant:"outlined"},e.secondaryAction)))})))))),u.a.createElement(O.a,{expanded:N,onChange:function(e,t){return B(t)}},u.a.createElement(w.a,{expandIcon:u.a.createElement(M.a,null)},u.a.createElement(b.a,null,"Configuration")),u.a.createElement(j.a,{className:a.dBlock},u.a.createElement(x.a,{disablePadding:!0},u.a.createElement(I,{disableVerticalPadding:!0,disableBorderRadius:!0},Z.map((function(e,t){return u.a.createElement(C.a,{key:t,divider:t!==ee.length-1,className:"listItemLeftPadding"},u.a.createElement(D.a,null,u.a.createElement(b.a,{variant:"body2"},e.title,e.helpText&&u.a.createElement("span",{onClick:function(){return Q({open:!0,title:'Help on "'.concat(e.title,'"'),text:u.a.createElement("p",null,e.helpText)})}},u.a.createElement(L,{title:"show help"})))),u.a.createElement(T.a,null,u.a.createElement(S.a,{variant:"outlined"},e.secondaryAction)))})))))))}));var J=function(e){var t=e.pushMessageToSnackbar;return u.a.createElement(l.Fragment,null,u.a.createElement(G,{pushMessageToSnackbar:t}))},$=a(951),Y=a(93);var _=Object(p.a)((function(){return{dBlock:{display:"block"}}}),{withTheme:!0})((function(e){var t=e.theme,a=e.classes,n=e.CardChart,r=e.data,o=Object(l.useState)(!1),c=Object(i.a)(o,2),s=c[0],m=c[1],d=Object(l.useState)(!1),p=Object(i.a)(d,2),g=p[0],h=p[1];return Object(l.useEffect)((function(){(r.dks.length>0||r.rpis.length>0)&&(m(!0),r.matches.length>0&&h(!0))}),[r]),u.a.createElement("div",null,u.a.createElement(O.a,{expanded:s,onChange:function(e,t){return m(t)}},u.a.createElement(w.a,{expandIcon:u.a.createElement(M.a,null)},u.a.createElement(b.a,null,"Input data")),u.a.createElement(j.a,{className:a.dBlock},n&&u.a.createElement($.a,{container:!0,spacing:3},r.dks.length>0&&u.a.createElement($.a,{item:!0,xs:12,md:6},u.a.createElement(n,{data:r.dks,color:t.palette.secondary.light,valueDescription:"count: ",height:"160px",title:"Diagnosis Keys (record count per day)"})),r.rpis.length>0&&u.a.createElement($.a,{item:!0,xs:12,md:6},u.a.createElement(n,{data:r.rpis,color:t.palette.primary.light,valueDescription:"count: ",height:"160px",title:"Bluetooth data (record count per day)"}))))),u.a.createElement(O.a,{expanded:g,onChange:function(e,t){return h(t)}},u.a.createElement(w.a,{expandIcon:u.a.createElement(M.a,null)},u.a.createElement(b.a,null,"Encounters data")),u.a.createElement(j.a,{className:a.dBlock},n&&u.a.createElement($.a,{container:!0,spacing:3},r.matches.map((function(e,a){var r=e.map((function(e){return e.timestamp})),o=Object(Y.a)(new Date(1e3*r[0]),"MMMM d, p"),c=Object(Y.a)(new Date(1e3*r[r.length-1]),"MMMM d, p");return u.a.createElement($.a,{item:!0,xs:12,md:12,key:a},u.a.createElement(n,{data:e,color:t.palette.primary.dark,height:"160px",valueDescription:"RSSI: ",title:"Between ".concat(o," and ").concat(c)}))}))))))})),Q=a(933),Z=a(952),ee=a(43),te=function(){var e=Object(c.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.a.get("/demo-dks.zip",{responseType:"arraybuffer"});case 2:return t=e.sent,e.abrupt("return",Object(ee.a)(t.data,!1));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(){return Math.round((new Date).getTime()/1e3)};var ne=Object(p.a)((function(e){return{paper:{borderBottomLeftRadius:0,borderBottomRightRadius:0},toolbar:{justifyContent:"space-between",padding:e.spacing(2)},scaleMinus:{transform:"scaleX(-1)"},"@keyframes spin":{from:{transform:"rotate(359deg)"},to:{transform:"rotate(0deg)"}},spin:{animation:"$spin 2s infinite linear"},listItemSecondaryAction:{paddingRight:e.spacing(1)}}}),{withTheme:!0})((function(e){var t=e.classes,a=e.processDksUpload,n=e.updateDks,r=e.pushMessageToMessages,o=e.pushMessageToSnackbar,c=Object(l.useRef)(null),s=Object(l.useState)(!1),m=Object(i.a)(s,2),d=m[0],p=m[1],g=Object(l.useState)(!1),h=Object(i.a)(g,2),b=h[0],f=h[1],E=Object(l.useContext)(F.a),y=E.downloadCountries,k=E.experimental,O={open:!1,messages:[]},w=Object(l.useState)(O),j=Object(i.a)(w,2),x=j[0],C=j[1],D=function(e,t){0!==y.filter((function(e){return e.enabled})).length?(t(!0),Promise.all(y.filter((function(e){return e.enabled})).map((function(t){return t.get(e)}))).then((function(e){var t=[],a=0,c=0,i=0;e.forEach((function(e){a+=e.errorCount,c+=e.dks.length,e.errorCount>0&&(t.push(u.a.createElement("p",{key:i},e.errorCount," errors in download from ",e.countryName,".")),i+=1)})),t.length>0&&(C({open:!0,messages:t}),r({text:"".concat(a," errors downloading Diagnosis Keys"),date:ae(),error:!0})),c>0&&r({text:"".concat(c," Diagnosis Keys downloaded"),date:ae(),error:!1}),o({text:"".concat(c," Diagnosis Keys downloaded")}),n(e.map((function(e){return e.dks})).flat())})).finally((function(){return setTimeout((function(){return t(!1)}),1e3)}))):o({text:"No countries selected"})};return u.a.createElement(Q.a,{className:t.paper},u.a.createElement(z.a,{fullScreen:!1,open:x.open,onClose:function(){return C(O)},"aria-labelledby":"errors"},u.a.createElement(W.a,{id:"errors"},"Error summary"),u.a.createElement(U.a,null,x.messages),u.a.createElement(V.a,null,u.a.createElement(v.a,{autoFocus:!0,onClick:function(){return C(O)},color:"primary"},"Close"))),u.a.createElement("input",{type:"file",id:"file",ref:c,onChange:function(e){var t=new FileReader;t.onload=function(e){a(e.target.result)},t.readAsArrayBuffer(e.target.files[0])},style:{display:"none"}}),u.a.createElement(Z.a,{className:t.toolbar},u.a.createElement($.a,{container:!0,spacing:2},k&&u.a.createElement("div",null,u.a.createElement($.a,{item:!0},u.a.createElement(v.a,{color:"primary",variant:"contained",onClick:function(){return D("/proxy/",p)},disabled:d},"Host ",d&&u.a.createElement(P,null))),u.a.createElement($.a,{item:!0},u.a.createElement(v.a,{color:"primary",variant:"contained",onClick:function(){return D("",f)},disabled:b},"Remote ",b&&u.a.createElement(P,null)))),u.a.createElement($.a,{item:!0},u.a.createElement(v.a,{color:"primary",variant:"contained",onClick:function(){c.current.click()}},"Open")),u.a.createElement($.a,{item:!0},u.a.createElement(v.a,{color:"primary",variant:"contained",onClick:function(){te().then((function(e){n(e),r({text:"".concat(e.length," demo Diagnosis Keys loaded"),date:ae(),error:!1}),o({text:"".concat(e.length," demo Diagnosis Keys loaded")})})).catch((function(e){return console.log("ERROR DOWNLOADING DEMO: "+e)}))}},"Demo")))))}));var re=Object(p.a)((function(e){return{paper:{borderBottomLeftRadius:0,borderBottomRightRadius:0},toolbar:{justifyContent:"space-between",padding:e.spacing(2)},scaleMinus:{transform:"scaleX(-1)"},"@keyframes spin":{from:{transform:"rotate(359deg)"},to:{transform:"rotate(0deg)"}},spin:{animation:"$spin 2s infinite linear"},listItemSecondaryAction:{paddingRight:e.spacing(1)}}}),{withTheme:!0})((function(e){var t=e.classes,a=e.processRpisUpload,n=e.pushMessageToSnackbar,r=Object(l.useRef)(null),o=Object(l.useState)(!1),c=Object(i.a)(o,2),s=c[0],m=c[1],d=Object(l.useContext)(F.a).experimental;return u.a.createElement(Q.a,{className:t.paper},u.a.createElement("input",{type:"file",id:"file",ref:r,onChange:function(e){var t=new FileReader;t.onload=function(e){a(e.target.result)},t.readAsArrayBuffer(e.target.files[0])},style:{display:"none"}}),u.a.createElement(Z.a,{className:t.toolbar},u.a.createElement($.a,{container:!0,spacing:2},d&&u.a.createElement($.a,{item:!0},u.a.createElement(v.a,{color:"primary",variant:"contained",onClick:function(){return m(!0),void X.a.get("/get",{responseType:"arraybuffer"}).then((function(e){return a(e.data)})).catch((function(e){return n({text:e.message})})).finally((function(){return setTimeout((function(){return m(!1)}),1e3)}))},disabled:s},"Host ",s&&u.a.createElement(P,null))),u.a.createElement($.a,{item:!0},u.a.createElement(v.a,{color:"primary",variant:"contained",onClick:function(){return r.current.click()}},"Open")),u.a.createElement($.a,{item:!0},u.a.createElement(v.a,{color:"primary",variant:"contained",onClick:function(){X.a.get("/demo-db.bin",{responseType:"arraybuffer"}).then((function(e){a(e.data)}))}},"Demo")))))}));var oe=Object(p.a)((function(e){return{paper:{borderBottomLeftRadius:0,borderBottomRightRadius:0},toolbar:{justifyContent:"space-between",padding:e.spacing(2)},scaleMinus:{transform:"scaleX(-1)"},"@keyframes spin":{from:{transform:"rotate(359deg)"},to:{transform:"rotate(0deg)"}},spin:{animation:"$spin 2s infinite linear"},listItemSecondaryAction:{paddingRight:e.spacing(1)}}}),{withTheme:!0})((function(e){var t=e.classes,a=e.processMatchingConfig,n=Object(l.useState)(!1),r=Object(i.a)(n,2),o=r[0],c=r[1];return u.a.createElement(Q.a,{className:t.paper},u.a.createElement(Z.a,{className:t.toolbar},u.a.createElement($.a,{container:!0,spacing:2},u.a.createElement($.a,{item:!0},u.a.createElement(v.a,{color:"primary",variant:"contained",disabled:o,onClick:function(){c(!0),a((function(){return c(!1)}))}},"Start ",o&&u.a.createElement(P,null))))))}));var ce=function(e){var t=e.selectDashboard,a=e.CardChart,n=e.statistics,r=e.processDksUpload,o=e.processRpisUpload,c=e.processMatchingConfig,s=e.updateDks,m=e.pushMessageToSnackbar,d=e.pushMessageToMessages;Object(l.useEffect)(t,[t]);var p={open:!1,title:"",text:u.a.createElement("div",null,"empty")},g=Object(l.useState)(p),f=Object(i.a)(g,2),E=f[0],y=f[1],k=Object(l.useContext)(F.a).experimental;return u.a.createElement(l.Fragment,null,u.a.createElement(z.a,{fullScreen:!1,open:E.open,onClose:function(){return y(p)},"aria-labelledby":"help"},u.a.createElement(W.a,{id:"help"},E.title),u.a.createElement(U.a,null,u.a.createElement(H.a,null,E.text)),u.a.createElement(V.a,null,u.a.createElement(v.a,{autoFocus:!0,onClick:function(){return y(p)},color:"primary"},"Close"))),k&&u.a.createElement("div",null,u.a.createElement(h.a,{mt:4},u.a.createElement(b.a,{variant:"subtitle1",gutterBottom:!0},"Settings")),u.a.createElement($.a,{container:!0,spacing:3},u.a.createElement($.a,{item:!0,xs:12},u.a.createElement(J,{pushMessageToSnackbar:m})))),u.a.createElement(h.a,{mt:4},u.a.createElement(b.a,{variant:"subtitle1",gutterBottom:!0})),u.a.createElement($.a,{container:!0,spacing:3},u.a.createElement($.a,{item:!0,xs:12,md:4},u.a.createElement(h.a,null,u.a.createElement(b.a,{variant:"subtitle1",gutterBottom:!0},"Choose Diagnosis Keys source",u.a.createElement("span",{onClick:function(){return y({open:!0,title:"How to provide Diagnosis Keys?",text:u.a.createElement("div",null,k&&u.a.createElement("div",null,u.a.createElement("p",null,u.a.createElement("b",null,"HOST")," will download official Diagnosis Keys from selected countries using reverse proxy on the host you deployed this application on (see deployment guide here). This mode does not work on covidexposure.org."),u.a.createElement("p",null,u.a.createElement("b",null,"REMOTE")," will attempt to download Diagnosis Keys directly but you need to disable CORS in the browser (see ",u.a.createElement("a",{href:"https://stackoverflow.com/questions/3102819/disable-same-origin-policy-in-chrome"},"instructions"),").")),u.a.createElement("p",null,u.a.createElement("b",null,"OPEN")," allows you to provide .zip file with Diagnosis Keys, see ",u.a.createElement("a",{href:"/demo-dks.zip"},"example file"),"."),u.a.createElement("p",null,u.a.createElement("b",null,"DEMO")," loads example Diagnosis Keys."))})}},u.a.createElement(L,{title:"show help"})))),u.a.createElement(ne,{processDksUpload:r,pushMessageToSnackbar:m,pushMessageToMessages:d,updateDks:s})),u.a.createElement($.a,{item:!0,xs:12,md:4},u.a.createElement(h.a,null,u.a.createElement(b.a,{variant:"subtitle1",gutterBottom:!0},"Choose Bluetooth data source",u.a.createElement("span",{onClick:function(){return y({open:!0,title:"How to provide Bluetooth data?",text:u.a.createElement("div",null,k&&u.a.createElement("p",null,u.a.createElement("b",null,"HOST")," will download Bluetooth data scanned by Raspberry Pi."),u.a.createElement("p",null,u.a.createElement("b",null,"OPEN")," allows you to provide protobuf file with Bluetooth data. See ",u.a.createElement("a",{href:"/rpi.proto"},"proto file")," and ",u.a.createElement("a",{href:"/demo-db.bin"},"example file"),". Check the source code for decoding / encoding details."),u.a.createElement("p",null,u.a.createElement("b",null,"DEMO")," loads example Bluetooth data."))})}},u.a.createElement(L,{title:"show help"})))),u.a.createElement(re,{processRpisUpload:o,pushMessageToSnackbar:m,pushMessageToMessages:d})),u.a.createElement($.a,{item:!0,xs:12,md:4},u.a.createElement(h.a,null,u.a.createElement(b.a,{variant:"subtitle1",gutterBottom:!0},"Find matches",u.a.createElement("span",{onClick:function(){return y({open:!0,title:"What will happen after starting matching?",text:u.a.createElement("div",null,u.a.createElement("p",null,u.a.createElement("b",null,"START")," will launch workers in your browser to find a match between provided Diagnosis Keys and Bluetooth data. For each Diagnosis Key a set of all generated beacon data is computed and matched against provided Bluetooth data. You will see the progress of each worker. The rest of the application will disappear temporarily to improve matching performance."))})}},u.a.createElement(L,{title:"show help"})))),u.a.createElement(oe,{processMatchingConfig:c}))),u.a.createElement(h.a,{mt:4},u.a.createElement(b.a,{variant:"subtitle1",gutterBottom:!0},n.matches.length+n.rpis.length+n.dks.length>0&&u.a.createElement("div",null,"Plots"))),u.a.createElement(_,{CardChart:a,data:n,pushMessageToMessages:d,pushMessageToSnackbar:m}))},ie=a(376);var se=Object(p.a)((function(e){var t;return{wrapper:(t={margin:e.spacing(1),width:"auto"},Object(s.a)(t,e.breakpoints.up("xs"),{width:"95%",marginLeft:"auto",marginRight:"auto",marginTop:e.spacing(4),marginBottom:e.spacing(4)}),Object(s.a)(t,e.breakpoints.up("sm"),{marginTop:e.spacing(6),marginBottom:e.spacing(6),width:"90%",marginLeft:"auto",marginRight:"auto"}),Object(s.a)(t,e.breakpoints.up("md"),{marginTop:e.spacing(6),marginBottom:e.spacing(6),width:"82.5%",marginLeft:"auto",marginRight:"auto"}),Object(s.a)(t,e.breakpoints.up("lg"),{marginTop:e.spacing(6),marginBottom:e.spacing(6),width:"70%",marginLeft:"auto",marginRight:"auto"}),t)}}),{withTheme:!0})(Object(l.memo)((function(e){var t=e.classes,a=e.CardChart,n=e.statistics,r=e.processDksUpload,o=e.processRpisUpload,c=e.processMatchingConfig,i=e.updateDks,s=e.targets,l=e.setTargets,m=e.pushMessageToSnackbar,d=e.selectDashboard,p=e.pushMessageToMessages;return u.a.createElement("div",{className:t.wrapper},u.a.createElement(g.c,null,u.a.createElement(ie.a,{path:"",component:ce,CardChart:a,statistics:n,processDksUpload:r,processRpisUpload:o,processMatchingConfig:c,updateDks:i,targets:s,setTargets:l,pushMessageToSnackbar:m,selectDashboard:d,pushMessageToMessages:p})))}))),le=a(89),ue=a(955),me=a(968),de=a(937),pe=a(973),ge=a(953),he=a(972),be=a(436),fe=a.n(be),Ee=a(575),ye=a.n(Ee),ke=a(437),ve=a.n(ke),Oe=a(377),we=a(932),je=a(956),xe=a(574),Ce=a.n(xe),De=a(954),Te=a(573),Se=a.n(Te),Re=a(900);var Me=function(e){var t=e.message,a=e.divider;return u.a.createElement(C.a,{divider:a},u.a.createElement(De.a,null,t.error&&u.a.createElement(Se.a,{color:"secondary"})),u.a.createElement(D.a,{primary:t.text,secondary:"".concat(Object(Re.a)(1e3*t.date,new Date)," ago")}))};var Ne=Object(p.a)((function(e){return{tabContainer:{overflowY:"auto",maxHeight:350},popoverPaper:Object(s.a)({width:"100%",maxWidth:350,marginLeft:e.spacing(2),marginRight:e.spacing(1)},e.breakpoints.down("sm"),{maxWidth:270}),divider:{marginTop:-2},noShadow:{boxShadow:"none !important"}}}),{withTheme:!0})((function(e){var t=e.classes,a=e.messages,n=Object(l.useRef)(),r=Object(l.useState)(!1),o=Object(i.a)(r,2),c=o[0],s=o[1],m=Object(l.useCallback)((function(){s(!c)}),[c,s]),d=Object(l.useCallback)((function(){s(!1)}),[s]),p=c?"scroll-playground":null;return u.a.createElement(l.Fragment,null,u.a.createElement(de.a,{onClick:m,buttonRef:n,"aria-label":"Open Events","aria-describedby":p,color:"primary"},u.a.createElement(Ce.a,null)),u.a.createElement(we.a,{disableScrollLock:!0,id:p,open:c,anchorEl:n.current,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},classes:{paper:t.popoverPaper},onClose:d},u.a.createElement(ue.a,{position:"static",color:"inherit",className:t.noShadow},u.a.createElement(h.a,{pt:1,pl:2,pb:1,pr:1},u.a.createElement(b.a,{variant:"subtitle1"},"Events")),u.a.createElement(je.a,{className:t.divider})),u.a.createElement(x.a,{dense:!0,className:t.tabContainer},0===a.length?u.a.createElement(C.a,null,u.a.createElement(D.a,null,"No events yet.")):a.map((function(e,t){return u.a.createElement(Me,{key:t,message:e,divider:t!==a.length-1})})))))}));var Be=Object(he.a)()(Object(p.a)((function(e){var t,a;return{appBar:Object(s.a)({boxShadow:e.shadows[6],backgroundColor:e.palette.common.white,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},e.breakpoints.down("xs"),{width:"100%",marginLeft:0}),appBarToolbar:(t={display:"flex",justifyContent:"space-between",paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},Object(s.a)(t,e.breakpoints.up("sm"),{paddingLeft:e.spacing(2),paddingRight:e.spacing(2)}),Object(s.a)(t,e.breakpoints.up("md"),{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}),Object(s.a)(t,e.breakpoints.up("lg"),{paddingLeft:e.spacing(4),paddingRight:e.spacing(4)}),t),accountAvatar:Object(s.a)({backgroundColor:e.palette.secondary.main,height:24,width:24,marginLeft:e.spacing(2),marginRight:e.spacing(2)},e.breakpoints.down("xs"),{marginLeft:e.spacing(1.5),marginRight:e.spacing(1.5)}),drawerPaper:(a={height:"100%vh",whiteSpace:"nowrap",border:0,width:e.spacing(7),overflowX:"hidden",marginTop:e.spacing(8)},Object(s.a)(a,e.breakpoints.up("sm"),{width:e.spacing(9)}),Object(s.a)(a,"backgroundColor",e.palette.common.black),a),smBordered:Object(s.a)({},e.breakpoints.down("xs"),{borderRadius:"50% !important"}),menuLink:{textDecoration:"none",color:e.palette.text.primary},iconListItem:{width:"auto",borderRadius:e.shape.borderRadius,paddingTop:11,paddingBottom:11,marginLeft:e.spacing(1),marginRight:e.spacing(1)},textPrimary:{color:e.palette.primary.main},mobileItemSelected:{backgroundColor:"".concat(e.palette.primary.main," !important")},brandText:{fontFamily:"'Roboto', cursive",fontWeight:400},username:{paddingLeft:0,paddingRight:e.spacing(2)},justifyCenter:{justifyContent:"center"},permanentDrawerListItem:{justifyContent:"center",paddingTop:e.spacing(2),paddingBottom:e.spacing(2)}}}),{withTheme:!0})((function(e){var t=e.selectedTab,a=e.messages,n=e.classes,r=Object(l.useRef)([]),o=Object(l.useState)(!1),c=Object(i.a)(o,2),s=c[0],m=c[1],d=Object(l.useCallback)((function(){m(!0)}),[m]),p=Object(l.useCallback)((function(){m(!1)}),[m]),g=[{link:"/covid-exposure/c/dashboard",name:"Dashboard",onClick:p,icon:{desktop:u.a.createElement(fe.a,{className:"Dashboard"===t?n.textPrimary:"text-white",fontSize:"small"}),mobile:u.a.createElement(fe.a,{className:"text-white"})}},{link:"/covid-exposure",name:"Logout",icon:{desktop:u.a.createElement(ye.a,{className:"text-white",fontSize:"small"}),mobile:u.a.createElement(ye.a,{className:"text-white"})}}];return u.a.createElement(l.Fragment,null,u.a.createElement(ue.a,{position:"sticky",className:n.appBar},u.a.createElement(Z.a,{className:n.appBarToolbar},u.a.createElement(h.a,{display:"flex",alignItems:"center"},u.a.createElement(me.a,{smUp:!0},u.a.createElement(h.a,{mr:1},u.a.createElement(de.a,{"aria-label":"Open Navigation",onClick:d,color:"primary"},u.a.createElement(ve.a,null)))),u.a.createElement(me.a,{xsDown:!0},u.a.createElement(b.a,{variant:"h4",className:n.brandText,display:"inline",color:"primary"},"COVID"),u.a.createElement(b.a,{variant:"h4",className:n.brandText,display:"inline",color:"secondary"},"exposure"))),u.a.createElement(h.a,{display:"flex",justifyContent:"flex-end",alignItems:"center",width:"100%"},u.a.createElement(Ne,{messages:a})))),u.a.createElement(me.a,{xsDown:!0},u.a.createElement(pe.a,{variant:"permanent",classes:{paper:n.drawerPaper},open:!1},u.a.createElement(x.a,null,g.map((function(e,a){return u.a.createElement(le.b,{to:e.link,className:n.menuLink,onClick:e.onClick,key:a,ref:function(e){r.current[a]=e}},u.a.createElement(N.a,{title:e.name,placement:"right",key:e.name},u.a.createElement(C.a,{selected:t===e.name,button:!0,divider:a!==g.length-1,className:n.permanentDrawerListItem,onClick:function(){r.current[a].click()},"aria-label":"Logout"===e.name?"Logout":"Go to ".concat(e.name)},u.a.createElement(ge.a,{className:n.justifyCenter},e.icon.desktop))))}))))),u.a.createElement(Oe.a,{menuItems:g.map((function(e){return{link:e.link,name:e.name,icon:e.icon.mobile,onClick:e.onClick}})),anchor:"left",open:s,selectedItem:t,onClose:p}))}))),Ke=a(344),Le=a(969);var Ie=Object(p.a)((function(e){return{root:{backgroundColor:e.palette.primary.main,paddingTop:0,paddingBottom:0}}}),{withTheme:!0})((function(e){var t=e.classes,a=e.getPushMessageFromChild,n=Object(l.useState)(!1),r=Object(i.a)(n,2),o=r[0],c=r[1],s=Object(l.useState)({}),m=Object(i.a)(s,2),d=m[0],p=m[1],g=Object(l.useRef)([]),h=Object(l.useCallback)((function(){g.current.length>0&&(p(g.current.shift()),c(!0))}),[p,c,g]),b=Object(l.useCallback)((function(e,t){"clickaway"!==t&&c(!1)}),[c]),f=Object(l.useCallback)((function(e){g.current.push({message:e,key:(new Date).getTime()}),o?c(!1):h()}),[g,o,c,h]);return Object(l.useEffect)((function(){a(f)}),[a,f]),u.a.createElement(Le.a,{disableWindowBlurListener:!0,key:d.key,anchorOrigin:{vertical:"bottom",horizontal:"left"},open:o,autoHideDuration:6e3,onClose:b,onExited:h,ContentProps:{classes:{root:t.root}},message:u.a.createElement("span",null,d.message?d.message.text:null)})})),Ae=a(81),Pe=a.n(Ae),Fe=a(576);t.default=Object(g.f)(Object(p.a)((function(e){return{main:Object(s.a)({marginLeft:e.spacing(9),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},e.breakpoints.down("xs"),{marginLeft:0})}}),{withTheme:!0})(Object(l.memo)((function(e){var t=e.classes,n=e.history,s=e.location,m=Object(l.useContext)(F.a),p=m.messages,g=m.cachingEnabled,h=m.dispatch,b=m.downloadCountries,f=m.numberWebWorkers,E=Object(l.useState)(null),y=Object(i.a)(E,2),k=y[0],O=y[1],w=Object(l.useState)(null),j=Object(i.a)(w,2),x=j[0],C=j[1],D=Object(l.useState)(!1),T=Object(i.a)(D,2),S=T[0],R=T[1],M=Object(l.useState)({dks:[],rpis:[],matches:[]}),N=Object(i.a)(M,2),B=N[0],K=N[1],L=Object(l.useState)([]),I=Object(i.a)(L,2),A=I[0],P=I[1],H=Object(l.useState)(null),q=Object(i.a)(H,2),G=q[0],J=q[1],$=Object(l.useState)({diagnosisKeys:[],rpiDbEntries:[],checkedDks:new Set,useCaching:g}),Y=Object(i.a)($,2),_=Y[0],Q=Y[1],Z={open:!1,content:u.a.createElement("div",null,"empty")},te=Object(l.useState)(Z),ne=Object(i.a)(te,2),re=ne[0],oe=ne[1],ce=function(e){h&&h({type:"addMessage",payload:e})};Object(l.useEffect)((function(){X.a.get("/covid-exposure/config").then((function(e){if(e.data){var t=e.data;h&&h({type:"updateConfig",payload:t})}})).catch((function(e){return console.log(e)})).finally((function(){if(s.state){var e=s.state;de(e.request.diagnosisKeys),me(e.request.rpiDbEntries),ue(e.response),e.response.size>0&&h?ce({text:"".concat(e.response.size," encounters found"),date:ae(),error:!1}):e.response.size>0&&ce({text:"No encounters found",date:ae(),error:!1}),oe({open:!0,content:u.a.createElement("div",null,e.response.size>0?u.a.createElement("p",null,u.a.createElement("b",null,"Found ",e.response.size," encounters!")," See plots for more details."):u.a.createElement("p",null,"No encounters found."))})}}))}),[]);var ie=function(){var e=Object(c.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={experimental:!1,downloadCountries:b,messages:[],cachingEnabled:g,numberWebWorkers:f},0!==_.rpiDbEntries.length&&0!==_.diagnosisKeys.length){e.next=5;break}return G&&G({text:"No Diagnosis Keys or Bluetooth data loaded"}),t(),e.abrupt("return");case 5:X.a.post("/covid-exposure/config",JSON.stringify(a)).finally((function(){g?X.a.get("/covid-exposure/checked",{responseType:"arraybuffer"}).then((function(e){var a=new Pe.a(e.data);try{var r=Fe.CheckedDKs.read(a);ce({text:"Loaded ".concat(r.checkedDKs.length," cached Diagnosis Keys"),date:ae(),error:!1}),n.push({pathname:"/covid-exposure/m/computing",state:Object(o.a)({},_,{useCaching:g,checkedDks:new Set(r.checkedDKs)})})}catch(c){ce({text:"Error parsing cached Diagnosis Keys",date:ae(),error:!0}),G&&G({text:"Error parsing cached Diagnosis Keys: "+c})}finally{t()}})).catch((function(e){ce({text:"Error downloading cached Diagnosis Keys",date:ae(),error:!0}),G&&G({text:"Error downloading cached Diagnosis Keys: "+e})})).finally((function(){return t()})):(t(),n.push({pathname:"/covid-exposure/m/computing",state:Object(o.a)({},_,{useCaching:g,checkedDks:new Set})}))}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(e){var t=[];return e.forEach((function(e,a){t.push({timestamp:a,value:e})})),t.sort((function(e,t){return e.timestamp-t.timestamp}))},ue=function(e){var t=[];e.forEach((function(e){var a=new Map;e.rpiDetails.forEach((function(e){a.set(e.timestamp,e.rssi)})),t.push(a)})),K((function(e){return Object(o.a)({},e,{matches:t.map((function(e){return le(e)}))})}))},me=function(e){Q((function(t){return Object(o.a)({},t,{rpiDbEntries:e})}));var t=new Map;e.forEach((function(e){var a=24*(e.key[0]<<8|e.key[1])*60*60,n=t.get(a);t.set(a,n?n+1:1)})),K((function(e){return Object(o.a)({},e,{rpis:le(t)})}))},de=function(e){Q((function(t){return Object(o.a)({},t,{diagnosisKeys:e})}));var t=e.map((function(e){return 600*e.rollingStart})),a=new Map;t.forEach((function(e){var t=a.get(e);a.set(e,t?t+1:1)})),K((function(e){return Object(o.a)({},e,{dks:le(a)})}))},pe=Object(l.useCallback)((function(){Object(Ke.a)(),document.title="COVIDexposure - Dashboard",O("Dashboard"),S||(R(!0),Promise.all([a.e(3),a.e(9)]).then(a.bind(null,957)).then((function(e){C(e.default)})))}),[O,C,S,R]),ge=Object(l.useCallback)((function(e){J((function(){return e}))}),[J]);return u.a.createElement(l.Fragment,null,u.a.createElement(z.a,{fullScreen:!1,open:re.open,onClose:function(){return oe(Z)},"aria-labelledby":"result-dialog"},u.a.createElement(W.a,{id:"result-dialog"},"Computation summary"),u.a.createElement(U.a,null,re.content),u.a.createElement(V.a,null,u.a.createElement(v.a,{autoFocus:!0,onClick:function(){return oe(Z)},color:"primary"},"Close"))),u.a.createElement(Be,{selectedTab:k,messages:p}),u.a.createElement(Ie,{getPushMessageFromChild:ge}),u.a.createElement("main",{className:d()(t.main)},u.a.createElement(se,{CardChart:x,statistics:B,processDksUpload:function(e){Object(ee.a)(e,!1).then((function(e){de(e),G({text:"".concat(e.length," Diagnosis Keys loaded")}),ce({text:"".concat(e.length," Diagnosis Keys loaded"),date:ae(),error:!1})})).catch((function(e){ce({text:"Error loading Diagnosis Keys",date:ae(),error:!0}),G({text:"Error parsing Diagnosis Keys: "+e})}))},processRpisUpload:function(e){try{var t=Object(ee.b)(e).entry;me(t),G({text:"".concat(t.length," Bluetooth scans loaded")}),ce({text:"".concat(t.length," Bluetooth scans loaded"),date:ae(),error:!1})}catch(a){ce({text:"Bluetooth scans could not be loaded",date:ae(),error:!0}),G({text:"Error parsing Bluetooth data: "+a})}},processMatchingConfig:ie,updateDks:de,targets:A,selectDashboard:pe,setTargets:P,pushMessageToSnackbar:G,pushMessageToMessages:ce})))}))))}}]);
//# sourceMappingURL=7.1d01e552.chunk.js.map